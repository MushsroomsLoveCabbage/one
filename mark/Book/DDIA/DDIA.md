### DDIA

####  1.现状

*（Data-intensive,Not Compute-intensive)
***可靠性***
fault(fault-tolerant)
不是prevent error 而是 容忍错误
备份
***可拓展性***
Response time(请求发起到得到响应时间）
latency 延迟（）
横向拓展和纵向拓展
***可维护性***
### 2. 数据模型与查询语言
JSON,XML
SQL(抽象语言）
关系型，文档模型，
文件型，列镞，键值
Schema-on-read(数据的结构是隐含的，只有在数据被读取时才被解释）
Schema-on-write(传统的关系型数据库，模式明确）
#### 3 存储与检索
#####   3.1存储

##### ***3.1.1 LSM(Log Structured Merge Tree)***

  * SST(Sorted String Table)稀疏（sparse)索引对应多个块，segment存储，多个段merge
  * 基于SST 实现内存－＞SST level 1->SST level 2->SST level 3(过多的层级遍历，可以用B1oom过滤来优化）
  * 压缩（单个segment内去重），合并（多个segment去重）策略
    日志 log append-only(顺序性写入）
    SSD一次擦除和重写相当大的存储芯片块

##### 3.1.2 B树

  * Write-ahead-log
    16*1024/
      ***列存储 ***
    *容易压缩
    *数据库持久化，消息队列（顺序性）
**检索***
    
* hash,B树，B+树，反向索引，SST(Sorted String Table)(多层级结构有点类似跳跃表）

#### 编码 
文本:JSON, XML
字节型:二进制字节（protobuf, thfift,avro)
arvo 动态模式，不固定格式，可以让问题在模式中转换。
#### 复制
* 解决的问题: 容忍节点故障，拓展性（读从），延迟(就近读取)）
* 每个单体有多个副本
* 模式: 单主多从，多主，无主
* 同步复制(数据完整一致，吞吐不高)，异步复制(短时间内不同步，可能会丢失，吞吐高),半同步复制(至少一半节点不同步)
* 问题: 复制延迟(read-your-wirte,读主),monotonic read 单调读，多次查询落到一个服务上(hash)

*** 新设置主节点
* 获取一次快照， 同步完后拉去快照最新的额log 日志更新，catch up 之后切主
* 复制方式：基于sql 语句，基于数据行（binlog）
* 通过log 日志来处理复制
* eventual consisitency 问题在于最终的具体时间是多久？

#### 分区
多个数据组合成一个整体
* 分区 (数据分散)
* 是否均匀
* 分区二级索引
* 拓展
* 分区路由


副本 (数据备份)
主，无主，
完整一致，隆低吞吐），异步复制（短时不同步甚至丢失，吞吐高），半同步复制（至少一个从节点和主同步）
（read-your-write,例如：对于只有玩家自己可以操作的信息，读主），（monotonic read 单调读 玩家多次查询操作路由到一个副本中）
I
步完后拉取快照到最新的1og日志更新，catch up 之后切主库
句（），基于数据行（binlog)
理复制
ency
（最终一致性的概念问题在于最终这个词模糊不清，多久是最终？）
整体
分区（SS Table),hash分区（更好的解决热点数据问题））
分区索引（本分区数据的局部索引），全局索引（全部分区的索引，索引分区，索引的更新采取异步更新方式））
平衡，保证机器负载均衡）
大新增分区保证动态拓展；分区压力小到某个临界值与其他分区合并）
中间件zookeeper来更新节点的分区变化）
于Cassandra,Riak 通过Gossip协议来节点内部间传播集群状态变化。任意节点接受请求）
＊主库挂掉，从库升级

获取响应
网络阻塞和排队
单调钟和时钟（wall-clock time)
LAST-WRITE-WIN(时钟节点滞后导致数据丢失）
semi-disconnected
半断开
（同步模型，半同步模型，异步模型）
（崩溃－停止，崩溃－恢复，拜占庭故障）
网络问题（请求超时，延迟，阻塞，排队，请求未收到，响应丢失，），处理问题 超时。
主机问题（宕机，GC,CPU分片），
时间同步问题（），
拜占庭问题（）
¥
lamport 逻辑时钟
大
脑裂（term 任期）
＃＃＃＃一致性与共识

convergence
收敛（最终一致性）
＊线性一致性（让整个系统看起来像是只有一个数据副本）
Consensus
共识
线性一致性
recency guarantee
protential
线性一致性 全序
total order
因果一致性 偏序
partially order
全序广播（可靠交付，全序交付）
批处理
map-reduce(任务可以回执重复执行）
two-phase-commit
流处理
（时间发生时间处理时间）按发生时间处理
spark
（微批）
flink
I





技术理应是服务于人，人工智能和大数据技术预测和分析普通群众的这种技术使用方式，同时也是在弱化人对于多元文化与认知的获得并且压制了人主动获得多种信息的能力，进而导致人群在各自的细分的认知领域中不断地强化自己的观点。问题在于被强化的群众以及观点是一群本身缺乏足够认知和是非判断，所以他们在被强化自我观点的同时，也是被误导的，陷入一种思维封闭区的时刻（微博上的那些被影响的网络喷子，键盘侠，以及低智人群），这种影响同时也在撕裂着整个社会的。把社会的各种细小问题无线的放大和激化。长久受到影响的普通群众在持久化的影响里会向沉默中默默死去或疯狂的报复社会中分化。而这受到伤害的其实始终是普通阶级群众，并且进而向上缓慢并且弱化的影响到上层阶级。技术预测可以用来预测一些天气等影响人类生存发展的客观情况，而非主动去预知人的未来并以此来限制人的发展和平等获得机会的权利（签证的地狱性歧视，银行的贷款限制等）。



技术的未来预测本身没有问题，但是对于人的预测，同时也是限制人的发展和机会，社会阶级无限趋近于固化。

