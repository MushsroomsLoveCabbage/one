### ServiceMesh

##### SideCar

- Load balance
- Circuit breaking
- Retris and deadlines
- Instrumentation
- Request Routing
- Service Discovery
- Metrics Collection
- Routing Policy

#### SideCar 实现方式

- 基于iptables 拦截

  - (流程)9080 ->15001 ==> 9080==>15001->9080

  - 网络层拦截，更适合云原生

- 协议转换的方式

  - (流程)9080 ->15001==>15001->9080



### Netty

- EventLoopGroup, ServerBootstrap,ChannelHandler
- Reactor, IO多路复用
- ZeroCopy(CompositeChannelBuffer，CompositeByteBuf),内存池，Pipeline

#### ZeroCopy

- file transfer ,数据直接从读缓冲区，转到写缓冲区
- 直接使用堆外内存
- CompositeByteBuf（抽象层整合多个ByteBuf）

#### JVM Heap 到 C Headp的Copy

- 在基于VM的IO操作中，需要把VM 中的数据复制到 c malloc() 或者类似函数分配的Heap 内存中，然后再复制到内核的写缓冲区中。对于JVM 来说是堆外内存，对应OS来说进程内的堆区。这么设计是因为JVM的对象实际内存布局不同于C，给的可能是个对象头而不是地址。垃圾回收会导致对象的位置移动
